<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physics Diagnostic</title>
    
    <!-- 1. Tailwind CSS (Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React & ReactDOM (The Core Engine) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 3. Babel (Translates code for the browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { background-color: #f8fafc; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <!-- If React fails to load, the user sees this message -->
    <div id="root" class="flex items-center justify-center min-h-screen text-slate-500">
        Loading App... (If this takes too long, refresh the page)
    </div>

    <script type="text/babel">
        // --- SAFE GLOBALS ---
        // We access React features directly from the window object to prevent errors
        const { useState, useMemo, useEffect } = React;

        // --- ICONS (Simple SVGs) ---
        const Icons = {
            Check: () => <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7"></path></svg>,
            X: () => <svg className="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"></path></svg>,
            ArrowRight: () => <svg className="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 5l7 7-7 7"></path></svg>,
            Refresh: () => <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
        };

        // --- DATA ---
        const QUESTIONS = [
            {
                id: 1,
                text: "Two metal balls are the same size but one weighs twice as much as the other. They are dropped from a roof at the same instant. The time it takes to reach the ground will be:",
                options: [
                    { id: 'A', text: "Half as long for the heavy ball." },
                    { id: 'B', text: "Half as long for the light ball." },
                    { id: 'C', text: "About the same for both balls." },
                    { id: 'D', text: "Considerably less for the heavy ball." },
                    { id: 'E', text: "Considerably less for the light ball." }
                ],
                correctAnswer: 'C',
                concept: "Gravity",
                explanation: "Galileo's principle: In the absence of air resistance, all objects fall with the same acceleration regardless of mass."
            },
            {
                id: 2,
                text: "A stone dropped from a roof to the earth:",
                options: [
                    { id: 'A', text: "Reaches max speed immediately then falls at constant speed." },
                    { id: 'B', text: "Speeds up because gravity gets stronger closer to earth." },
                    { id: 'C', text: "Speeds up because of a constant gravitational force." },
                    { id: 'D', text: "Falls because of a natural tendency to rest." },
                    { id: 'E', text: "Falls due to combined gravity and air pressure." }
                ],
                correctAnswer: 'C',
                concept: "Acceleration",
                explanation: "Gravity exerts a constant force, causing constant acceleration (speeding up) the entire way down."
            },
            {
                id: 3,
                text: "A large truck collides head-on with a small car. During the collision:",
                options: [
                    { id: 'A', text: "The truck exerts more force on the car." },
                    { id: 'B', text: "The car exerts more force on the truck." },
                    { id: 'C', text: "Neither exerts force on the other." },
                    { id: 'D', text: "The truck exerts force, the car does not." },
                    { id: 'E', text: "They exert the same amount of force on each other." }
                ],
                correctAnswer: 'E',
                concept: "Newton's 3rd Law",
                explanation: "Newton's 3rd Law: For every action, there is an equal and opposite reaction. The forces are identical."
            },
            {
                id: 4,
                text: "A ball is swung in a circle on a string. If the string breaks, which path will the ball follow?",
                options: [
                    { id: 'A', text: "Curved path outwards." },
                    { id: 'B', text: "Straight line tangent to the circle." },
                    { id: 'C', text: "Straight line outwards from center." },
                    { id: 'D', text: "Curved path inwards." }
                ],
                correctAnswer: 'B',
                concept: "Inertia",
                explanation: "Without the string's force, the ball continues in a straight line due to inertia (Newton's 1st Law)."
            },
            {
                id: 5,
                text: "After a ball is thrown straight up (after leaving the hand), the forces acting on it are:",
                options: [
                    { id: 'A', text: "Gravity down, and a decreasing upward force." },
                    { id: 'B', text: "Decreasing upward force only." },
                    { id: 'C', text: "Gravity down and a constant upward force." },
                    { id: 'D', text: "Gravity down only." },
                    { id: 'E', text: "None of the above." }
                ],
                correctAnswer: 'D',
                concept: "Force Identification",
                explanation: "Once it leaves the hand, the only force acting on it is gravity (ignoring air resistance)."
            }
        ];

        // --- APP COMPONENT ---
        function App() {
            const [index, setIndex] = useState(0);
            const [answers, setAnswers] = useState({});
            const [submitted, setSubmitted] = useState(false);
            const [showResults, setShowResults] = useState(false);

            const question = QUESTIONS[index];
            const isLast = index === QUESTIONS.length - 1;

            // Handle clicking an option
            const handleOptionClick = (optId) => {
                if (submitted) return;
                setAnswers(prev => ({ ...prev, [question.id]: optId }));
            };

            // Handle "Check Answer"
            const handleCheck = () => {
                setSubmitted(true);
            };

            // Handle "Next"
            const handleNext = () => {
                if (isLast) {
                    setShowResults(true);
                } else {
                    setIndex(prev => prev + 1);
                    setSubmitted(false);
                }
            };

            // Calculate Results
            const results = useMemo(() => {
                let correctCount = 0;
                const conceptStats = {};

                QUESTIONS.forEach(q => {
                    const isCorrect = answers[q.id] === q.correctAnswer;
                    if (isCorrect) correctCount++;
                    
                    if (!conceptStats[q.concept]) conceptStats[q.concept] = { total: 0, correct: 0 };
                    conceptStats[q.concept].total++;
                    if (isCorrect) conceptStats[q.concept].correct++;
                });

                return {
                    score: correctCount,
                    percentage: Math.round((correctCount / QUESTIONS.length) * 100),
                    concepts: Object.entries(conceptStats).map(([name, stats]) => ({
                        name,
                        percent: Math.round((stats.correct / stats.total) * 100)
                    }))
                };
            }, [answers, showResults]);

            // --- RENDER: RESULTS SCREEN ---
            if (showResults) {
                return (
                    <div className="max-w-md mx-auto mt-10 bg-white rounded-xl shadow-lg overflow-hidden fade-in m-4">
                        <div className="bg-slate-800 p-8 text-center text-white">
                            <h1 className="text-3xl font-bold">{results.percentage}%</h1>
                            <p className="text-slate-300 mt-2">You got {results.score} out of {QUESTIONS.length} correct</p>
                        </div>
                        
                        <div className="p-6 space-y-6">
                            <div>
                                <h3 className="font-bold text-slate-700 mb-4">Concept Mastery</h3>
                                <div className="space-y-3">
                                    {results.concepts.map(c => (
                                        <div key={c.name}>
                                            <div className="flex justify-between text-sm mb-1">
                                                <span>{c.name}</span>
                                                <span className="font-bold">{c.percent}%</span>
                                            </div>
                                            <div className="w-full bg-slate-100 rounded-full h-2.5">
                                                <div 
                                                    className="bg-indigo-600 h-2.5 rounded-full" 
                                                    style={{ width: `${c.percent}%` }}
                                                ></div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <button 
                                onClick={() => window.location.reload()} 
                                className="w-full py-3 bg-slate-100 hover:bg-slate-200 text-slate-800 rounded-lg font-bold flex items-center justify-center transition-colors"
                            >
                                <Icons.Refresh /> Retake Quiz
                            </button>
                        </div>
                    </div>
                );
            }

            // --- RENDER: QUIZ SCREEN ---
            return (
                <div className="min-h-screen flex items-center justify-center p-4">
                    <div className="w-full max-w-lg bg-white rounded-xl shadow-xl overflow-hidden flex flex-col" style={{ minHeight: '500px' }}>
                        
                        {/* Header */}
                        <div className="p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                            <span className="font-bold text-slate-700">Physics Quiz</span>
                            <span className="text-sm text-slate-500">Q{index + 1} of {QUESTIONS.length}</span>
                        </div>

                        {/* Progress Bar */}
                        <div className="w-full bg-slate-100 h-1">
                            <div 
                                className="bg-indigo-600 h-1 transition-all duration-300" 
                                style={{ width: `${((index + 1) / QUESTIONS.length) * 100}%` }}
                            ></div>
                        </div>

                        {/* Content */}
                        <div className="p-6 flex-1 overflow-y-auto">
                            <h2 className="text-lg font-medium text-slate-800 mb-6 leading-relaxed">
                                {question.text}
                            </h2>

                            <div className="space-y-3">
                                {question.options.map(opt => {
                                    const isSelected = answers[question.id] === opt.id;
                                    const isCorrect = opt.id === question.correctAnswer;
                                    
                                    let btnClass = "border-slate-200 hover:bg-slate-50";
                                    
                                    if (submitted) {
                                        if (isCorrect) btnClass = "bg-green-50 border-green-500 text-green-800";
                                        else if (isSelected) btnClass = "bg-red-50 border-red-300 text-red-800";
                                        else btnClass = "opacity-50 border-slate-100";
                                    } else if (isSelected) {
                                        btnClass = "border-indigo-600 bg-indigo-50 text-indigo-700 ring-1 ring-indigo-600";
                                    }

                                    return (
                                        <button
                                            key={opt.id}
                                            onClick={() => handleOptionClick(opt.id)}
                                            disabled={submitted}
                                            className={`w-full text-left p-4 rounded-lg border transition-all ${btnClass}`}
                                        >
                                            <div className="flex gap-3">
                                                <span className="font-bold">{opt.id}.</span>
                                                <span>{opt.text}</span>
                                            </div>
                                        </button>
                                    );
                                })}
                            </div>

                            {submitted && (
                                <div className="mt-6 p-4 bg-blue-50 border border-blue-100 rounded-lg text-sm text-blue-800 fade-in">
                                    <p className="font-bold mb-1">Explanation:</p>
                                    {question.explanation}
                                </div>
                            )}
                        </div>

                        {/* Footer */}
                        <div className="p-4 border-t border-slate-100 bg-slate-50">
                            {!submitted ? (
                                <button 
                                    onClick={handleCheck}
                                    disabled={!answers[question.id]}
                                    className="w-full py-3 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                                >
                                    Check Answer
                                </button>
                            ) : (
                                <button 
                                    onClick={handleNext}
                                    className="w-full py-3 bg-slate-800 text-white rounded-lg font-bold hover:bg-slate-700 flex items-center justify-center transition-colors"
                                >
                                    {isLast ? "See Results" : "Next Question"} <Icons.ArrowRight />
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // --- MOUNT THE APP ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
